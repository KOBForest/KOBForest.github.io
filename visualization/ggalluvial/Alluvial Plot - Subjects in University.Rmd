---
title: "Alluvial Plots - School Subjects"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggalluvial)
```



```{r}

head(majors)

```


```{r cars}
data(majors)
majors$curriculum <- as.factor(majors$curriculum)

p<- ggplot(majors,
       aes(x = semester, stratum = curriculum, alluvium = student,
           fill = curriculum, label = curriculum)) +
  scale_fill_brewer(type = "qual", palette = "Set2") 
p

```

```{r}
p<- p + geom_flow(stat = "alluvium", lode.guidance = "frontback",
            color = "darkgray") +
  geom_stratum()

p

```

```{r}  
  
p<- p + theme(legend.position = "bottom") +
  ggtitle("student curricula across several semesters")
p
```